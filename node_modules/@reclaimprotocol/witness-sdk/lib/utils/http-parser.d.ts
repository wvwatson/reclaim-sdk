/// <reference types="node" />
import type { IncomingHttpHeaders } from 'http';
import { TLSReceipt } from '../proto/api';
import { ArraySlice } from '../types';
type HttpRequest = {
    method: string;
    url: string;
    protocol: string;
    headers: IncomingHttpHeaders;
};
type HttpResponse = {
    statusCode: number;
    statusMessage: string;
    headers: IncomingHttpHeaders;
    body: Uint8Array;
    headersComplete: boolean;
    complete: boolean;
    /**
     * Index of the first byte of the status line
     */
    statusLineEndIndex?: number;
    /**
     * Index of the first byte of the body
     * in the complete response
     */
    bodyStartIndex?: number;
    /**
     * If using chunked transfer encoding,
     * this will be set & contain indices of each
     * chunk in the complete response
     */
    chunks?: ArraySlice[];
};
export declare const CLIENT_CERTIFICATE_RESPONSE_CIPHERTEXT_SIZE = 37;
/**
 * parses http/1.1 responses
 */
export declare function makeHttpResponseParser(): {
    res: HttpResponse;
    /**
     * Parse the next chunk of data
     * @param data the data to parse
     */
    onChunk(data: Uint8Array): void;
    /**
     * Call to prevent further parsing; indicating the end of the request
     * Checks that the response is valid & complete, otherwise throws an error
     */
    streamEnded(): void;
};
/**
 * Extract the HTTP response from a TLS receipt transcript.
 * Will throw an error if the response is incomplete or redacted.
 * @returns the http response
 */
export declare function getCompleteHttpResponseFromTranscript(transcript: TLSReceipt['transcript']): HttpResponse;
/**
 * Read the HTTP request from a TLS receipt transcript.
 * Note: this currently does not read a body, only headers.
 *
 * @param transcript the transcript to read from
 * @returns the parsed HTTP request
 */
export declare function getHttpRequestHeadersFromTranscript(transcript: TLSReceipt['transcript']): HttpRequest;
export {};
