import { Logger, ProcessPacket } from '../types';
import { PACKET_TYPE } from './constants';
type PacketType = keyof typeof PACKET_TYPE;
type PacketHeaderOptions = {
    type: PacketType;
    protoVersion?: Uint8Array;
};
export type PacketOptions = {
    type: PacketType;
    protoVersion?: Uint8Array;
    data: Uint8Array;
};
export declare function packPacketHeader(dataLength: number, { type, protoVersion }: PacketHeaderOptions): Uint8Array;
export declare function packPacket(opts: PacketOptions): Uint8Array;
/**
 * Packs data prefixed with the length of the data;
 * Length encoded UInt24 big endian
 */
export declare function packWith3ByteLength(data: Uint8Array): Uint8Array;
export declare function readWithLength(data: Uint8Array, lengthBytes?: number): Uint8Array | undefined;
export declare function expectReadWithLength(data: Uint8Array, lengthBytes?: number): Uint8Array;
/**
 * Packs data prefixed with the length of the data;
 * Length encoded UInt16 big endian
 */
export declare function packWithLength(data: Uint8Array): Uint8Array;
/**
 * Processes an incoming stream of TLS packets
 */
export declare function makeMessageProcessor(logger: Logger): {
    getPendingBuffer(): Uint8Array;
    /**
     * @param packet TLS packet;
     * can be multiple packets concatenated
     * or incomplete packet
     * or a single packet
     * @param onChunk handle a complete packet
     */
    onData(packet: Uint8Array, onChunk: ProcessPacket): void;
    reset(): void;
};
export {};
